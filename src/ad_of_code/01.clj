(ns advent-of-code
  (:require [clojure.string :as str]))

(defn- convert-input-to-seq-of-numbers [input-string]
  (map read-string (str/split input-string #"") ))

(defn getSum [input]
  (let [sequence-of-numbers (convert-input-to-seq-of-numbers input)
        first-value (first sequence-of-numbers)
        last-value (last sequence-of-numbers)
        initial-sum (if (= first-value last-value) last-value 0)]

    (reduce 
      (fn [acc next-value]
        (if (= (:prev-value acc) next-value)
          (merge acc {:sum (+ (:sum acc) next-value) :prev-value next-value})
          (merge acc {:prev-value next-value}) )) 
      {:sum initial-sum :first-value first-value :prev-value nil}
      sequence-of-numbers)))

(defn getSum2 [input]
  (let [sequence-of-numbers (convert-input-to-seq-of-numbers input)
        length-of-list (count sequence-of-numbers)
        steps-to-take (/ length-of-list 2)
        inital-value {:current-item 0, :total-sum 0, :input-sequence sequence-of-numbers}]

        (reduce
          (fn [acc next-value]
            (let [halfway-around-index (mod (+ (:current-item acc) steps-to-take) length-of-list)
                  value-halfway-around (nth (:input-sequence acc)  halfway-around-index)]

              (if (= next-value value-halfway-around)
                 (merge acc {:current-item (+ (:current-item acc) 1) :total-sum (+ (:total-sum acc) next-value)})
                 (merge acc {:current-item (+ (:current-item acc) 1)} )))) 
          inital-value
          sequence-of-numbers)))

(println (getSum2 "1212"))
(println (getSum2 "1221"))
(println (getSum2 "123425"))
(println (getSum2 "123123"))
(println (getSum2 "12131415"))

;; 1212 produces 6: the list contains 4 items, and all four digits match the digit 2 items ahead.
;; 1221 produces 0, because every comparison is between a 1 and a 2.
;; 123425 produces 4, because both 2s match each other, but no other digit has a match.
;; 123123 produces 12.
;; 12131415 produces 4.


(println (getSum2 "878938232157342756754254716586975125394865297349321236586574662994429894259828536842781199252169182743449435231194436368218599463391544461745472922916562414854275449983442828344463893618282425242643322822916857935242141636187859919626885791572268272442711988367762865741341467274718149255173686839265874184176985561996454253165784192929453678326937728571781212155346592432874244741816166328693958529938367575669663228335566435273484331452883175981955679335327231995452231118936393192583338222595982522833468533262224874637449624644318418748617949417939228988293391941457722641936417456243894182668197174255786445994567477582715692336249243254711653529871336129825735249667425238573952339922948214218872417858525199642194588448543565474847272984232637466664695217176358283788781843171636841215675851778984619377575696447366844854289534215286959727688419731976631323833892247438149829975856161755122857643731945913335556288817112993911694972667656914238999291831997163412548977649491227219477796124134958527843213824792685117696631512141241496451845758655276186597724748432996276498527911292531185292149948139724345841584782352214921634858734671118495424143437282979243347831258285851259579133433182387444656386679831584933397915132785411686688447731696776459621924821667112751789884987883991845818513249994767543526169463766975791464756526911587399764736557959464923353896921342944821833991457125329564489631352268722457628514564128231487382111682976886838192412996932924373337524262135399658638418515239876732866596731888779532573243713128238419234963195589987539467221517535272384899524386267268959484881379944796392255419838743164714275463459351741296586465213689853743856518583451849661592844879264196761867481258778393623584884535246239794178981387632311238115362178576899121425428114696158652976277392224226268242332589546757477683398264294929442592131949398261884548427951472128841328376819241955153423452531538413492577262348369581399947624623868299468436859667152463974949436359589931136236247929554899679139746162554183855278713574244211854227829969443151478986413333429144796664423754818172862812877688675514142265239992529776262844329188218189254491238956497568"))

